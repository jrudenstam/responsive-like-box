/*
Responsive Facebook Like Box 1.0
https://github.com/jrudenstam/responsive-like-box

Copyright 2012 Jacob Rudenstam

Released under MIT license
http://jrudenstam.mit-license.org/
*/
;(function($){if(!(window.addEventListener&&document.createEvent&&window.dispatchEvent&&JSON&&window.getComputedStyle)){return;}
var dispatchResizeEndEvent=function(){var event=document.createEvent("Event");event.initEvent("resizeend",false,false);window.dispatchEvent(event);};var getCurrentOrientation=function(){return Math.abs(+window.orientation||0)%180;};var initialOrientation=getCurrentOrientation();var currentOrientation;var resizeDebounceTimeout;window.addEventListener("resize",function(){currentOrientation=getCurrentOrientation();if(currentOrientation!==initialOrientation){dispatchResizeEndEvent();initialOrientation=currentOrientation;}
else{clearTimeout(resizeDebounceTimeout);resizeDebounceTimeout=setTimeout(dispatchResizeEndEvent,100);}},false);$.fn.responsiveLikeBox=function(options){var settings=$.extend({initialTimeout:5,loaderSrc:'img/ajax-loader.gif'},options);var defaults={width:this.attr('data-width'),height:this.attr('data-height'),colorScheme:this.attr('data-colorscheme'),showFaces:this.attr('data-show-faces'),borderColor:this.attr('data-border-color'),showStream:this.attr('data-stream'),showHeader:this.attr('data-header')};var helpers={translateToUri:{width:'width',height:'height',colorScheme:'colorscheme',showFaces:'show_faces',borderColor:'border_color',showStream:'stream',showHeader:'header'},translateToDataAttr:{width:'data-width',height:'data-height',colorScheme:'data-colorscheme',showFaces:'data-show-faces',borderColor:'data-border-color',showStream:'data-stream',showHeader:'data-header'}};return this.each(function(){var widget=this,loader;widget.init=function(){loader=$('<img class="responsive-lb-loader" src="'+settings.loaderSrc+'" alt="Loading..."/>').appendTo(widget.wrapper.el.parent());return $(this).each(function(){$(window).bind('load.responsiveLikeBox resizeend.responsiveLikeBox',widget.iframe.resize);});};widget.wrapper={el:$(this),apperance:function(el,type){var data=window.getComputedStyle(el,'::after').content;if(data&&data!='none'){data=data.substring(1,data.length-1).replace(/\\/g,'');if(type!='string'){try{data=$.parseJSON(data);}
catch(e){$('<p class="error-msg">There seem to be a problem with your JSON format in your CSS. The error message says: <strong>'+e.message+'</strong></p>').appendTo(el);data='';}}}
else{if(type!='string'){data=defaults;}
else{data=JSON.stringify(defaults);}}
return data;}};widget.iframe={apperance:defaults,resizing:false,resize:function(){widget.iframe.el=widget.wrapper.el.find('iframe');widget.iframe.el.bind('load.responsiveLikeBox',function(){widget.iframe.apperance=widget.iframe.newApperanceString;loader.hide();widget.iframe.el.show();});if(widget.iframe.el.attr('src')){widget.iframe.newApperanceString=widget.wrapper.apperance(widget,'string');if(widget.iframe.apperance!=widget.iframe.newApperanceString&&!widget.iframe.resizing){widget.iframe.resizing=true;var newApperance=widget.wrapper.apperance(widget);var newSrc=widget.iframe.el.attr('src');for(var option in newApperance){widget.wrapper.el.attr(helpers.translateToDataAttr[option],newApperance[option]);var regEx=new RegExp('[?&]'+helpers.translateToUri[option]+'=([a-z0-9%]*)','g');try{var query=newSrc.match(regEx).toString();newSrc=newSrc.replace(regEx,query.substring(0,1)+helpers.translateToUri[option]+'='+window.escape(newApperance[option]));}
catch(e){console.log('Seems you want to change something you did not specify in your original implementation. If you want to change eg. border-color yo need to specify a border color when you get the code for your fb likebox. Error: '+e.message);}
if(option==='width'||option==='height'){widget.wrapper.el.children('span').css(option,newApperance[option]);widget.iframe.el.css(option,newApperance[option]);}}
widget.iframe.el.attr('src',newSrc);loader.show();widget.iframe.el.hide();widget.iframe.resizing=false;}}
else{if(settings.initialTimeout){setTimeout(widget.iframe.resize,500);}
else{loader.hide();}
settings.initialTimeout--;}}};widget.init();});};})(jQuery);